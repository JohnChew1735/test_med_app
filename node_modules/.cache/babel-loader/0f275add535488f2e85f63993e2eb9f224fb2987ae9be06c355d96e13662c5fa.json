{"ast":null,"code":"import _objectSpread from\"/home/project/test_med_app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from\"react\";import{API_URL}from\"../../config\";import{useNavigate}from\"react-router-dom\";import\"./ProfileForm.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProfileForm=()=>{const[userDetails,setUserDetails]=useState({name:\"\",email:\"\",phone:\"\"});const[updatedDetails,setUpdatedDetails]=useState({name:\"\",email:\"\",phone:\"\"});const[errors,setErrors]=useState({});const[editMode,setEditMode]=useState(false);const navigate=useNavigate();useEffect(()=>{const authtoken=sessionStorage.getItem(\"auth-token\");if(!authtoken){navigate(\"/login\");}else{fetchUserProfile();}},[navigate]);const fetchUserProfile=async()=>{try{const authtoken=sessionStorage.getItem(\"auth-token\");const email=sessionStorage.getItem(\"email\");const response=await fetch(\"\".concat(API_URL,\"/api/auth/user\"),{headers:{Authorization:\"Bearer \".concat(authtoken),Email:email}});if(response.ok){const user=await response.json();setUserDetails(user);setUpdatedDetails(user);}else{throw new Error(\"Failed to fetch user profile\");}}catch(error){console.error(error);}};const handleEdit=()=>{setErrors({});setEditMode(true);};const handleInputChange=e=>{setUpdatedDetails(_objectSpread(_objectSpread({},updatedDetails),{},{[e.target.name]:e.target.value}));};// ✅ Validate before submitting\nconst validateForm=()=>{let newErrors={};if(!updatedDetails.name.trim()){newErrors.name=\"Name is required.\";}if(!updatedDetails.phone.trim()){newErrors.phone=\"Phone number is required.\";}const emailPattern=/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;if(updatedDetails.email&&!emailPattern.test(updatedDetails.email)){newErrors.email=\"Invalid email address.\";}setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleSubmit=async e=>{e.preventDefault();if(!validateForm()){return;// Stop here if validation fails\n}try{const authtoken=sessionStorage.getItem(\"auth-token\");const email=sessionStorage.getItem(\"email\");const response=await fetch(\"\".concat(API_URL,\"/api/auth/user\"),{method:\"PUT\",headers:{Authorization:\"Bearer \".concat(authtoken),\"Content-Type\":\"application/json\",Email:email},body:JSON.stringify(updatedDetails)});if(response.ok){sessionStorage.setItem(\"name\",updatedDetails.name);sessionStorage.setItem(\"phone\",updatedDetails.phone);setUserDetails(updatedDetails);setEditMode(false);alert(\"Profile Updated Successfully!\");navigate(\"/\");}else{throw new Error(\"Failed to update profile\");}}catch(error){console.error(error);alert(\"An error occurred while updating your profile.\");}};return/*#__PURE__*/_jsx(\"div\",{className:\"profile-container\",children:editMode?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"profile-form\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Edit Profile\"}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Email:\",/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:userDetails.email,disabled:true}),errors.email&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:errors.email})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Name:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:updatedDetails.name,onChange:handleInputChange}),errors.name&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:errors.name})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Phone:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"phone\",value:updatedDetails.phone,onChange:handleInputChange}),errors.phone&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:errors.phone})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"save-btn\",children:\"Save\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"profile-details\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Welcome, \",userDetails.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Email:\"}),\" \",userDetails.email]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Phone:\"}),\" \",userDetails.phone]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleEdit,className:\"edit-btn\",children:\"Edit\"})]})});};export default ProfileForm;","map":{"version":3,"names":["React","useEffect","useState","API_URL","useNavigate","jsx","_jsx","jsxs","_jsxs","ProfileForm","userDetails","setUserDetails","name","email","phone","updatedDetails","setUpdatedDetails","errors","setErrors","editMode","setEditMode","navigate","authtoken","sessionStorage","getItem","fetchUserProfile","response","fetch","concat","headers","Authorization","Email","ok","user","json","Error","error","console","handleEdit","handleInputChange","e","_objectSpread","target","value","validateForm","newErrors","trim","emailPattern","test","Object","keys","length","handleSubmit","preventDefault","method","body","JSON","stringify","setItem","alert","className","children","onSubmit","type","disabled","onChange","onClick"],"sources":["/home/project/test_med_app/src/Components/ProfileForm/ProfileForm.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { API_URL } from \"../../config\";\nimport { useNavigate } from \"react-router-dom\";\nimport \"./ProfileForm.css\";\n\nconst ProfileForm = () => {\n  const [userDetails, setUserDetails] = useState({ name: \"\", email: \"\", phone: \"\" });\n  const [updatedDetails, setUpdatedDetails] = useState({ name: \"\", email: \"\", phone: \"\" });\n  const [errors, setErrors] = useState({});\n  const [editMode, setEditMode] = useState(false);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const authtoken = sessionStorage.getItem(\"auth-token\");\n    if (!authtoken) {\n      navigate(\"/login\");\n    } else {\n      fetchUserProfile();\n    }\n  }, [navigate]);\n\n  const fetchUserProfile = async () => {\n    try {\n      const authtoken = sessionStorage.getItem(\"auth-token\");\n      const email = sessionStorage.getItem(\"email\");\n\n      const response = await fetch(`${API_URL}/api/auth/user`, {\n        headers: {\n          Authorization: `Bearer ${authtoken}`,\n          Email: email,\n        },\n      });\n\n      if (response.ok) {\n        const user = await response.json();\n        setUserDetails(user);\n        setUpdatedDetails(user);\n      } else {\n        throw new Error(\"Failed to fetch user profile\");\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  const handleEdit = () => {\n    setErrors({});\n    setEditMode(true);\n  };\n\n  const handleInputChange = (e) => {\n    setUpdatedDetails({\n      ...updatedDetails,\n      [e.target.name]: e.target.value,\n    });\n  };\n\n  // ✅ Validate before submitting\n  const validateForm = () => {\n    let newErrors = {};\n\n    if (!updatedDetails.name.trim()) {\n      newErrors.name = \"Name is required.\";\n    }\n\n    if (!updatedDetails.phone.trim()) {\n      newErrors.phone = \"Phone number is required.\";\n    }\n\n    const emailPattern = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (updatedDetails.email && !emailPattern.test(updatedDetails.email)) {\n      newErrors.email = \"Invalid email address.\";\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    if (!validateForm()) {\n      return; // Stop here if validation fails\n    }\n\n    try {\n      const authtoken = sessionStorage.getItem(\"auth-token\");\n      const email = sessionStorage.getItem(\"email\");\n\n      const response = await fetch(`${API_URL}/api/auth/user`, {\n        method: \"PUT\",\n        headers: {\n          Authorization: `Bearer ${authtoken}`,\n          \"Content-Type\": \"application/json\",\n          Email: email,\n        },\n        body: JSON.stringify(updatedDetails),\n      });\n\n      if (response.ok) {\n        sessionStorage.setItem(\"name\", updatedDetails.name);\n        sessionStorage.setItem(\"phone\", updatedDetails.phone);\n        setUserDetails(updatedDetails);\n        setEditMode(false);\n        alert(\"Profile Updated Successfully!\");\n        navigate(\"/\");\n      } else {\n        throw new Error(\"Failed to update profile\");\n      }\n    } catch (error) {\n      console.error(error);\n      alert(\"An error occurred while updating your profile.\");\n    }\n  };\n\n  return (\n    <div className=\"profile-container\">\n      {editMode ? (\n        <form onSubmit={handleSubmit} className=\"profile-form\">\n          <h2>Edit Profile</h2>\n\n          <label>\n            Email:\n            <input type=\"email\" name=\"email\" value={userDetails.email} disabled />\n            {errors.email && <p className=\"error\">{errors.email}</p>}\n          </label>\n\n          <label>\n            Name:\n            <input\n              type=\"text\"\n              name=\"name\"\n              value={updatedDetails.name}\n              onChange={handleInputChange}\n            />\n            {errors.name && <p className=\"error\">{errors.name}</p>}\n          </label>\n\n          <label>\n            Phone:\n            <input\n              type=\"text\"\n              name=\"phone\"\n              value={updatedDetails.phone}\n              onChange={handleInputChange}\n            />\n            {errors.phone && <p className=\"error\">{errors.phone}</p>}\n          </label>\n\n          <button type=\"submit\" className=\"save-btn\">Save</button>\n        </form>\n      ) : (\n        <div className=\"profile-details\">\n          <h2>Welcome, {userDetails.name}</h2>\n          <p><b>Email:</b> {userDetails.email}</p>\n          <p><b>Phone:</b> {userDetails.phone}</p>\n          <button onClick={handleEdit} className=\"edit-btn\">Edit</button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ProfileForm;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}